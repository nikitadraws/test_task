{"ast":null,"code":"/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License\n * 2.0 and the Server Side Public License, v 1; you may not use this file except\n * in compliance with, at your election, the Elastic License 2.0 or the Server\n * Side Public License, v 1.\n */\n\n/**\n * Secures outbound links. For more info:\n * https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/\n */\nimport { isDomainSecure } from '../url';\nexport const getSecureRelForTarget = _ref => {\n  let {\n    href,\n    target = '',\n    rel\n  } = _ref;\n  const isElasticHref = !!href && isDomainSecure(href);\n  const relParts = !!rel ? rel.split(' ').filter(part => !!part.length && part !== 'noreferrer') : [];\n  if (!isElasticHref) {\n    relParts.push('noreferrer');\n  }\n  if (target.includes('_blank') && relParts.indexOf('noopener') === -1) {\n    relParts.push('noopener');\n  }\n  return relParts.sort().join(' ').trim();\n};","map":{"version":3,"names":["isDomainSecure","getSecureRelForTarget","href","target","rel","isElasticHref","relParts","split","filter","part","length","push","includes","indexOf","sort","join","trim"],"sources":["/Users/nikita/Downloads/super_date_picker/src/services/security/get_secure_rel_for_target.ts"],"sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License\n * 2.0 and the Server Side Public License, v 1; you may not use this file except\n * in compliance with, at your election, the Elastic License 2.0 or the Server\n * Side Public License, v 1.\n */\n\n/**\n * Secures outbound links. For more info:\n * https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/\n */\nimport { isDomainSecure } from '../url';\n\nexport const getSecureRelForTarget = ({\n  href,\n  target = '',\n  rel,\n}: {\n  href?: string;\n  target?: '_blank' | '_self' | '_parent' | '_top' | string;\n  rel?: string;\n}) => {\n  const isElasticHref = !!href && isDomainSecure(href);\n  const relParts = !!rel\n    ? rel.split(' ').filter((part) => !!part.length && part !== 'noreferrer')\n    : [];\n\n  if (!isElasticHref) {\n    relParts.push('noreferrer');\n  }\n\n  if (target.includes('_blank') && relParts.indexOf('noopener') === -1) {\n    relParts.push('noopener');\n  }\n\n  return relParts.sort().join(' ').trim();\n};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAASA,cAAc,QAAQ,QAAQ;AAEvC,OAAO,MAAMC,qBAAqB,GAAG,QAQ/B;EAAA,IARgC;IACpCC,IAAI;IACJC,MAAM,GAAG,EAAE;IACXC;EAKF,CAAC;EACC,MAAMC,aAAa,GAAG,CAAC,CAACH,IAAI,IAAIF,cAAc,CAACE,IAAI,CAAC;EACpD,MAAMI,QAAQ,GAAG,CAAC,CAACF,GAAG,GAClBA,GAAG,CAACG,KAAK,CAAC,GAAG,CAAC,CAACC,MAAM,CAAEC,IAAI,IAAK,CAAC,CAACA,IAAI,CAACC,MAAM,IAAID,IAAI,KAAK,YAAY,CAAC,GACvE,EAAE;EAEN,IAAI,CAACJ,aAAa,EAAE;IAClBC,QAAQ,CAACK,IAAI,CAAC,YAAY,CAAC;EAC7B;EAEA,IAAIR,MAAM,CAACS,QAAQ,CAAC,QAAQ,CAAC,IAAIN,QAAQ,CAACO,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,EAAE;IACpEP,QAAQ,CAACK,IAAI,CAAC,UAAU,CAAC;EAC3B;EAEA,OAAOL,QAAQ,CAACQ,IAAI,EAAE,CAACC,IAAI,CAAC,GAAG,CAAC,CAACC,IAAI,EAAE;AACzC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}